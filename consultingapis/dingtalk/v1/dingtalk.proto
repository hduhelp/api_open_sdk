syntax = "proto3";

package consultingapis.dingtalk.v1;

import "google/api/annotations.proto";

option go_package = "./consultingapis/dingtalk/v1";

service DingTalkService {
  rpc CreateClassChatGroup(CreateClassChatGroupRequest) returns (CreateClassChatGroupResponse) {
    option (google.api.http) = {
      post: "/dingtalk/chat/v1/create"
      body: "body"
    };
  }

  rpc GetClassChatGroup(GetClassChatGroupRequest) returns (GetClassChatGroupResponse) {
    option (google.api.http) = {
      get: "/dingtalk/chat/v1/get"
    };
  }

  rpc MergeClassChatGroup(MergeClassChatGroupRequest) returns (MergeClassChatGroupResponse) {
    option (google.api.http) = {
      get: "/dingtalk/chat/v1/merge"
    };
  }

  rpc SyncClassChatGroup(SyncClassChatGroupRequest) returns (SyncClassChatGroupResponse) {
    option (google.api.http) = {
      get: "/dingtalk/chat/v1/sync"
    };
  }

  rpc CreateGradeChatGroup(CreateGradeChatGroupRequest) returns (CreateGradeChatGroupResponse) {
    option (google.api.http) = {
      post: "/dingtalk/chat/v1/unit/create"
    };
  }

  rpc GetGradeChatGroup(GetGradeChatGroupRequest) returns (GetGradeChatGroupResponse) {
    option (google.api.http) = {
      get: "/dingtalk/chat/v1/unit/get"
    };
  }

  rpc SyncGradeChatGroup(SyncGradeChatGroupRequest) returns (SyncGradeChatGroupResponse) {
    option (google.api.http) = {
      get: "/dingtalk/chat/v1/unit/sync"
    };
  }

  rpc CreateRecruitChatGroup(CreateRecruitChatGroupRequest) returns (CreateRecruitChatGroupResponse) {
    option (google.api.http) = {
      post: "/dingtalk/chat/v1/recruit/create"
      body: "body"
    };
  }

  rpc GetPreviousSchoolChatGroup(GetPreviousSchoolChatGroupRequest) returns (GetPreviousSchoolChatGroupResponse) {
    option (google.api.http) = {
      get: "/dingtalk/chat/v1/previous_school/get"
    };
  }

  rpc CreatePreviousSchoolChatGroup(CreatePreviousSchoolChatGroupRequest) returns (CreatePreviousSchoolChatGroupResponse) {
    option (google.api.http) = {
      post: "/dingtalk/chat/v1/previous_school/create"
      body: "body"
    };
  }

  rpc JoinPreviousSchoolChatGroup(JoinPreviousSchoolChatGroupRequest) returns (JoinPreviousSchoolChatGroupResponse) {
    option (google.api.http) = {
      post: "/dingtalk/chat/v1/previous_school/join"
      body: "body"
    };
  }
}

message CreatePreviousSchoolChatGroupRequest {
  Body body = 1;

  message Body {
    string school_name = 1;
    string grade = 2;
  }
}

message CreatePreviousSchoolChatGroupResponse {
  PreviousSchoolChatGroup chat_group = 1;
}

message JoinPreviousSchoolChatGroupRequest {
  Body body = 1;

  message Body {
    string openConversationId = 1;
  }
}

message JoinPreviousSchoolChatGroupResponse {
  string message = 1;
}

message GetPreviousSchoolChatGroupRequest {
  string school_name = 1;
  string grade = 2;
}

message GetPreviousSchoolChatGroupResponse {
  repeated PreviousSchoolChatGroup chat_groups = 1;
}

message PreviousSchoolChatGroup {
  string chat_id = 1;
  string openConversationId = 2;
  string invite_url = 3;
  int64 created_at = 4;
  string chat_name = 5;
  string grade = 6;
  string school_name = 7;
}

message CreateClassChatGroupRequest {
  string class_id = 1;
  Body body = 2;

  message Body {
    string name = 1;
  }
}

message CreateClassChatGroupResponse {
  string chat_id = 1;
  string openConversationId = 2;
  string invite_url = 3;
}

message MergeClassChatGroupRequest {
  string class_id = 1;
  string openConversationId = 2;
}

message MergeClassChatGroupResponse {}

message GetClassChatGroupRequest {
  string class_id = 1;
}

message GetClassChatGroupResponse {
  repeated Chat chats = 1;

  message Chat {
    string chat_id = 1;
    string openConversationId = 2;
    string invite_url = 3;
    int64 created_at = 4;
  }
}

message SyncClassChatGroupRequest {
  string class_id = 1;
}

message SyncClassChatGroupResponse {
  string message = 1;
}


message CreateGradeChatGroupRequest {
  string unitId = 1; // 学院ID
  string grade = 2; // 年级
}

message CreateGradeChatGroupResponse {
  string chat_id = 1;
  string openConversationId = 2;
  string invite_url = 3;
}

message GetGradeChatGroupRequest {
  string unitId = 1;
  string grade = 2;
}

message GetGradeChatGroupResponse {
  repeated Chat chats = 1;

  message Chat {
    string chat_id = 1;
    string openConversationId = 2;
    string invite_url = 3;
    int64 created_at = 4;
  }
}

message SyncGradeChatGroupRequest {
  string unitId = 1;
  string grade = 2;
}

message SyncGradeChatGroupResponse {
  string message = 1;
}

message CreateRecruitChatGroupRequest{
  Body body = 1;
  message Body {
    repeated string member_id = 1;
    string name = 2;
  }
}

message CreateRecruitChatGroupResponse{
  string chat_id = 1;
  string openConversationId = 2;
  string invite_url = 3;
  string failed_member_ids = 4;
}